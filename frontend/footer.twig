</main>
    <footer class="bg-white shadow-inner p-4 mt-auto">
        <div class="container mx-auto text-center">
            <div class="text-sm text-gray-600">
                <span>Última atualização de dados às {{ atualizacao.execution_time }}</span>
            </div>
            <div class="text-xs text-gray-400 mt-1">
                <span>Copyright &copy; DADOS WAZE {{ "now"|date("Y") }}</span>
            </div>
        </div>
    </footer>

    </div>
    </div>
<a class="fixed bottom-5 right-5 p-3 bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-700 transition duration-300 ease-in-out hidden"
    href="#page-top" id="scrollTopBtn">
    <i class="fas fa-angle-up"></i>
</a>

<div id="logoutModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-sm mx-auto p-6">
        <div class="flex justify-between items-start">
            <h5 class="text-xl font-semibold text-gray-900" id="exampleModalLabel">Pronto para sair?</h5>
            <button class="text-gray-400 hover:text-gray-600" data-modal-close="logoutModal" aria-label="Close">
                <span class="text-2xl" aria-hidden="true">×</span>
            </button>
        </div>
        <div class="my-4 text-gray-600">Ao selecionar "Sair", sua sessão será encerrada.</div>
        <div class="flex justify-end space-x-3">
            <button class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition duration-150"
                data-modal-close="logoutModal">
                Cancelar
            </button>
            <a class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition duration-150"
                href="/logout.php">
                Sair
            </a>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1.x/dist/chartjs-chart-matrix.min.js"></script>

<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script>
    // ----------------------------------------------------------------------------------
    // 1. Script para Sidebar (Menu Lateral)
    // ----------------------------------------------------------------------------------
    $(document).ready(function() {
        const sidebar = $('#sidebar-menu');
        const contentWrapper = $('#content-wrapper');

        // Toggle Sidebar (funcionalidade de minimização)
        $('#sidebarToggle').on('click', function(e) {
            e.preventDefault();
            sidebar.toggleClass('w-64 w-20');
            // Mudar o ícone do botão
            $(this).find('i').toggleClass('fa-angle-left fa-angle-right');
            // Esconder o nome do sistema na versão minimizada
            sidebar.find('.sidebar-brand-text').toggleClass('hidden lg:inline');
            // Esconder textos dos links (manter apenas ícones)
            sidebar.find('.nav-link-item span').toggleClass('hidden');
            sidebar.find('.nav-link-collapse span').toggleClass('hidden');
        });
        
        // Toggle Mobile Menu
        $('#mobile-menu-toggle').on('click', function() {
             sidebar.toggleClass('hidden');
             // Para telas maiores, garantir que está visível (se for o caso)
             sidebar.removeClass('lg:hidden'); 
        });

        // Toggle do Dropdown de Monitoramento
        $('#collapse-link-1').on('click', function(e) {
            e.preventDefault();
            const target = $($(this).attr('href'));
            const icon = $(this).find('i.fa-angle-right');
            target.slideToggle(300);
            icon.toggleClass('rotate-90');
        });

        // ----------------------------------------------------------------------------------
        // 2. Script para Dropdown de Usuário (Topbar)
        // ----------------------------------------------------------------------------------
        $('#userDropdown').on('click', function() {
            $('#userDropdownMenu').toggleClass('hidden');
        });
        // Fechar o dropdown ao clicar fora
        $(document).on('click', function(event) {
            if (!$(event.target).closest('#userDropdown, #userDropdownMenu').length) {
                $('#userDropdownMenu').addClass('hidden');
            }
        });

        // ----------------------------------------------------------------------------------
        // 3. Script para Modais (LogoutModal)
        // ----------------------------------------------------------------------------------
        // Abrir Modal
        $('[data-modal-target]').on('click', function(e) {
            e.preventDefault();
            const targetId = $(this).data('modal-target');
            $('#' + targetId).removeClass('hidden').addClass('flex');
        });

        // Fechar Modal
        $('[data-modal-close]').on('click', function(e) {
            e.preventDefault();
            const targetId = $(this).data('modal-close');
            $('#' + targetId).removeClass('flex').addClass('hidden');
        });
        
        // ----------------------------------------------------------------------------------
        // 4. Scroll to Top
        // ----------------------------------------------------------------------------------
        $(window).scroll(function() {
            if ($(this).scrollTop() > 100) {
                $('#scrollTopBtn').removeClass('hidden');
            } else {
                $('#scrollTopBtn').addClass('hidden');
            }
        });
        $('#scrollTopBtn').click(function(e) {
            e.preventDefault();
            $('html, body').animate({
                scrollTop: 0
            }, 600);
            return false;
        });

        // ----------------------------------------------------------------------------------
        // 5. Script de Atualização (Recuperado do seu header.twig)
        // ----------------------------------------------------------------------------------
        const currentUrl = window.location.pathname.substring(1).split('/')[0];
        const validPages = ['home', 'dashboard', 'routes', 'irregularidades'];

        if (validPages.includes(currentUrl)) {
            // Atualiza a página a cada 180.000 milissegundos (3 minutos)
            setInterval(function() {
                window.location.reload();
            }, 180000);
        }
    });
</script>

</body>
</html>