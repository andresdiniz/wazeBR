<!-- Footer -->
<footer class="sticky-footer bg-white">
    <div class="container my-auto">
        <div class="copyright text-center my-auto">
            <span>Última atualização de dados às {{atualizacao.execution_time}} </span>
            <span>Copyright &copy; DADOS WAZE {{ "now"|date("Y") }}</span>
        </div>
    </div>
</footer>

</div>
<!-- End of Content Wrapper -->

</div>
<!-- End of Page Wrapper -->

<!-- Scroll to Top Button-->
<a class="scroll-to-top rounded" href="#page-top" aria-label="Voltar ao topo">
    <i class="fas fa-angle-up" aria-hidden="true"></i>
</a>

<!-- Logout Modal-->
<div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="logoutModalLabel">Pronto para sair?</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
            </div>
            <div class="modal-body">
                Selecione "Logout" abaixo se você está pronto para encerrar sua sessão atual.
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-bs-dismiss="modal">Cancelar</button>
                <a class="btn btn-primary" href="login.html">Logout</a>
            </div>
        </div>
    </div>
</div>

<!-- Scripts Manager - Carregamento otimizado -->
<script>
(function() {
    'use strict';
    
    // Configuração centralizada dos scripts
    const SCRIPT_CONFIG = {
        // Scripts críticos que devem carregar primeiro
        critical: [
            {
                src: 'https://code.jquery.com/jquery-3.7.1.min.js',
                integrity: 'sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=',
                crossorigin: 'anonymous'
            }
        ],
        // Scripts que dependem do jQuery
        jquery_dependent: [
            {
                src: 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js',
                crossorigin: 'anonymous'
            },
            {
                src: 'https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js',
                crossorigin: 'anonymous'
            },
            {
                src: 'https://cdn.datatables.net/responsive/2.3.0/js/dataTables.responsive.min.js',
                crossorigin: 'anonymous'
            }
        ],
        // Scripts independentes
        independent: [
            {
                src: 'https://unpkg.com/leaflet/dist/leaflet.js',
                crossorigin: 'anonymous'
            },
            {
                src: 'https://cdn.jsdelivr.net/npm/sweetalert2@11',
                crossorigin: 'anonymous'
            },
            {
                src: 'https://cdn.jsdelivr.net/npm/chart.js',
                crossorigin: 'anonymous'
            }
        ],
        // Scripts locais
        local: [
            './js/sb-admin-2.min.js',
            './js/scripts.js'
        ]
    };
    
    // Função para carregar script com Promise
    function loadScript(config) {
        return new Promise((resolve, reject) => {
            const script = document.createElement('script');
            script.src = config.src || config;
            
            if (config.integrity) script.integrity = config.integrity;
            if (config.crossorigin) script.crossOrigin = config.crossorigin;
            
            script.onload = resolve;
            script.onerror = reject;
            
            document.head.appendChild(script);
        });
    }
    
    // Função para carregar múltiplos scripts
    async function loadScripts(scripts) {
        try {
            await Promise.all(scripts.map(loadScript));
        } catch (error) {
            console.warn('Erro ao carregar script:', error);
        }
    }
    
    // Função principal de carregamento
    async function loadAllScripts() {
        try {
            // 1. Carrega scripts críticos primeiro
            await loadScripts(SCRIPT_CONFIG.critical);
            
            // 2. Carrega scripts independentes em paralelo
            const independentPromise = loadScripts(SCRIPT_CONFIG.independent);
            
            // 3. Carrega scripts que dependem do jQuery
            const jqueryDependentPromise = loadScripts(SCRIPT_CONFIG.jquery_dependent);
            
            // 4. Aguarda scripts independentes e jQuery dependentes
            await Promise.all([independentPromise, jqueryDependentPromise]);
            
            // 5. Carrega scripts locais por último
            await loadScripts(SCRIPT_CONFIG.local);
            
            console.log('Todos os scripts carregados com sucesso');
            
        } catch (error) {
            console.error('Erro no carregamento dos scripts:', error);
        }
    }
    
    // Inicia o carregamento quando DOM estiver pronto
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadAllScripts);
    } else {
        loadAllScripts();
    }
})();
</script>

<!-- Vendor Scripts Locais (fallback) -->
<script>
// Verificação e fallback para scripts locais
document.addEventListener('DOMContentLoaded', function() {
    // Fallback para jQuery local se CDN falhar
    if (typeof jQuery === 'undefined') {
        const fallbackScript = document.createElement('script');
        fallbackScript.src = 'vendor/jquery/jquery.min.js';
        document.head.appendChild(fallbackScript);
    }
    
    // Carrega outros vendors locais se necessário
    const vendorScripts = [
        'vendor/bootstrap/js/bootstrap.bundle.min.js',
        'vendor/jquery-easing/jquery.easing.min.js'
    ];
    
    vendorScripts.forEach(src => {
        const script = document.createElement('script');
        script.src = src;
        script.async = true;
        document.head.appendChild(script);
    });
});
</script>

<!-- Performance Monitor (opcional - remover em produção) -->
<script>
if (window.performance) {
    window.addEventListener('load', function() {
        setTimeout(function() {
            const perfData = window.performance.timing;
            const loadTime = perfData.loadEventEnd - perfData.navigationStart;
            console.log(`Página carregada em: ${loadTime}ms`);
        }, 0);
    });
}
</script>

</body>
</html>